!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("hammerjs")):"function"==typeof define&&define.amd?define(["hammerjs"],e):"object"==typeof exports?exports.WS=e(require("hammerjs")):t.WS=e(t.Hammer)}(window,function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=2)}([function(t,e,n){!function(e,n){t.exports=n()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s="./src/index.ts")}({"./node_modules/weighted-interval-merge/dist/weighted-interval-merge.js":
/*!******************************************************************************!*\
  !*** ./node_modules/weighted-interval-merge/dist/weighted-interval-merge.js ***!
  \******************************************************************************/
/*! no static exports found */function(t,e,n){!function(t){"use strict";var e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},n=function(t){return t.start+t.offsetStart},r=function(t){return t.map(function(t){return e({},t,{offsetStart:t.offsetStart||0,index:t.index||1})})},i=function(t){var e=0,n=Number.MIN_SAFE_INTEGER;return t.forEach(function(t){t.index>n?(n=t.index,t.index=++e):t.index=e}),t},a=function(t){return t.sort(function(t,e){return c(t.index,e.index)||c(n(t),n(e))})},o=function(t){return t.reduce(function(t,e){return(t[e.index]=t[e.index]||[]).push(e),t},{})},s=function(t){var e=null,n=!0,r=!1,i=void 0;try{for(var a,o=Object.keys(t)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,c=l(t[s]);e=null==e?c:u(c,e)}}catch(t){r=!0,i=t}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}return e},l=function(t){if(t.length<=1)return t;for(var r=[],i=t[0],a=1;a<t.length;a++){var o=t[a];i.end>=o.end||(n(o)<i.end?(r.push(e({},i,{end:n(o)})),i=o):(r.push(i),i=o))}return r.push(i),r},u=function(t,r){for(var i=0,a=0,o=[];i<t.length||a<r.length;){var s=t[i],l=r[a];i===t.length?(o.push(e({},l)),a++):a===r.length?(o.push(e({},s)),i++):n(s)<=n(l)?(s.end<=n(l)||(s.end<l.end?l.offsetStart=s.end-l.start:a++),o.push(e({},s)),i++):l.end<=n(s)?(o.push(e({},l)),a++):s.end>l.end?(o.push(e({},l,{end:n(s)})),a++):(o.push(e({},l,{end:n(s)})),l.offsetStart=s.end-l.start)}return o},c=function(t,e){return t>e?1:t<e?-1:0};t.weightedIntervalMerge=function(t){if(null==t||0===t.length)return[];var e=a(t),n=i(e),l=r(n),u=o(l);return s(u)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},"./src/config/managerconfig.ts":
/*!*************************************!*\
  !*** ./src/config/managerconfig.ts ***!
  \*************************************/
/*! no static exports found */function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.default={scrollPosition:0,samplesPerPixel:1024,resolution:10,meterType:"rms",width:300,samplerate:44100}},"./src/core/track.ts":
/*!***************************!*\
  !*** ./src/core/track.ts ***!
  \***************************/
/*! no static exports found */function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(/*! ../strategies/peak */"./src/strategies/peak.ts"),i=n(/*! ../strategies/rms */"./src/strategies/rms.ts"),a=n(/*! weighted-interval-merge */"./node_modules/weighted-interval-merge/dist/weighted-interval-merge.js"),o=function(){function t(t,e,n){this.width=n,this._lastValue=new Float32Array(4*this.width),this.id=t,this.intervals=e||[],this._flattened=a.weightedIntervalMerge(this.intervals)}return Object.defineProperty(t.prototype,"flattened",{get:function(){return this._flattened.slice()},enumerable:!0,configurable:!0}),t.prototype.flatten=function(){this._flattened=a.weightedIntervalMerge(this.intervals)},t.prototype.getDuration=function(){return Math.max.apply(Math,this.intervals.map(function(t){return t.end}))},t.prototype.calculate=function(t,e,n,a,o){switch(t.meterType){case"peak":this._lastValue=r.default(t,this.flattened,e,n,a,o,this._lastValue);break;default:this._lastValue=i.default(t,this.flattened,e,n,a,o,this._lastValue)}return this._lastValue},t}();e.default=o},"./src/core/waveshaper.ts":
/*!********************************!*\
  !*** ./src/core/waveshaper.ts ***!
  \********************************/
/*! no static exports found */function(t,e,n){var r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(/*! ./track */"./src/core/track.ts"),a=n(/*! ../config/managerconfig */"./src/config/managerconfig.ts"),o=function(){function t(t){void 0===t&&(t=a.default),this.tracks=new Map,this.audioData=new Map,this.callbackMap=new Map,this.segmentCallbackMap=new Array,this.optionsCallbacks=new Array,this._activeWaveShapers=[],this.validateOptions(t),this._options=r({},a.default,t)}return Object.defineProperty(t.prototype,"options",{get:function(){return r({},this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeWaveShapers",{get:function(){return this._activeWaveShapers.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastProcessResult",{get:function(){return this._lastProcessResult},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),t.prototype.timeToPosition=function(t){return t*this._options.samplerate/this._options.samplesPerPixel},t.prototype.positionToTime=function(t){return t*this._options.samplesPerPixel/this._options.samplerate},t.prototype.flatten=function(t){var e=this;return void 0===t&&(t=[]),this.getProcessIds(t).forEach(function(t){var n=e.getTrack(t);null!=n&&n.flatten()}),this},t.prototype.process=function(t,e,n,i){void 0===t&&(t=[]),void 0===e&&(e=0),void 0===n&&(n=this.options.width),void 0===i&&(i=0);for(var a=this.getProcessIds(t),o=r({},this.options),s=[],l=0;l<a.length;l++){var u=a[l],c=this.getTrack(u);if(null!=c){var f=c.calculate(o,this.audioData,e,n,i);s.push({id:u,data:f})}}return this._lastProcessResult={options:o,data:s},this.invokeCallbacks(this._lastProcessResult,e,n,i),this},t.prototype.on=function(t,e){var n=this.callbackMap.get(t);return null==n?this.callbackMap.set(t,[e]):n.push(e),this},t.prototype.off=function(t,e){var n=this.callbackMap.get(t);if(null==n)return this;var r=n.indexOf(e);return r<0?this:(n=n.splice(r,1),this)},t.prototype.onSegment=function(t){this.segmentCallbackMap.push(t)},t.prototype.offSegment=function(t){var e=this.segmentCallbackMap.indexOf(t);-1!==e&&this.segmentCallbackMap.splice(e,1)},t.prototype.emitSegment=function(t,e){this.segmentCallbackMap.forEach(function(n){return n(t,e)})},t.prototype.onOptions=function(t){this.optionsCallbacks.push(t)},t.prototype.offOptions=function(t){var e=this.optionsCallbacks.indexOf(t);-1!==e&&this.optionsCallbacks.splice(e,1)},t.prototype.emitOptions=function(t,e){this.optionsCallbacks.forEach(function(n){return n(t,e)})},t.prototype.setOptions=function(t){this.validateOptions(t);var e=r({},this.options);return this._options=r({},e,t),this.emitOptions(e,this.options),this},t.prototype.setTracks=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++){var r=t[n],a=this.getTrack(r.id);if(null==a){var o=new i.default(r.id,r.intervals,this._options.width);this.tracks.set(r.id,o)}else a.intervals=r.intervals||[],a.flatten()}return this._duration=this.getDuration(),this},t.prototype.setData=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e.forEach(function(e){t.audioData.set(e.id,e.data)}),this},t.prototype.setActive=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._activeWaveShapers=t,this},t.prototype.clearTracks=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e.forEach(function(e){t.removeCallbacksById(e),t.tracks.delete(e)}),this},t.prototype.getTrack=function(t){return this.tracks.get(t)},t.prototype.validateOptions=function(t){var e=this._options||a.default;(!t.samplesPerPixel||t.samplesPerPixel<=0)&&(t.samplesPerPixel=e.samplesPerPixel),t.meterType||(t.meterType=e.meterType),(!t.resolution||t.resolution<=0)&&(t.resolution=e.resolution),(!t.width||this.options.width<=0)&&(t.width=e.width),(!t.scrollPosition||this.options.scrollPosition<=0)&&(t.scrollPosition=e.scrollPosition),(!t.samplerate||this.options.samplerate<=0)&&(t.samplerate=e.samplerate)},t.prototype.invokeCallbacks=function(t,e,n,r){for(var i=0;i<t.data.length;i++){var a=t.data[i],o=this.callbackMap.get(a.id);if(null!=o)for(var s=0;s<o.length;s++){(0,o[s])(t.options,new Float32Array(a.data),e,n,r)}}},t.prototype.getProcessIds=function(t){return t.length>0?t:this._activeWaveShapers.length>0?this._activeWaveShapers:Array.from(this.tracks.keys())},t.prototype.removeCallbacksById=function(t){var e=this.callbackMap.get(t);null!=e&&(e.splice(0,e.length),this.callbackMap.delete(t))},t.prototype.getDuration=function(){return Array.from(this.tracks.values()).reduce(function(t,e){var n=e.getDuration();return n>t?n:t},0)},t}();e.default=o},"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! no static exports found */function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(/*! ./core/waveshaper */"./src/core/waveshaper.ts");e.WaveShaper=r.default;var i=n(/*! ./core/track */"./src/core/track.ts");e.Track=i.default;var a=n(/*! ./config/managerconfig */"./src/config/managerconfig.ts");e.defaultConfig=a.default;var o=n(/*! ./strategies/rms */"./src/strategies/rms.ts");e.rms=o.default;var s=n(/*! ./strategies/peak */"./src/strategies/peak.ts");e.peak=s.default},"./src/strategies/peak.ts":
/*!********************************!*\
  !*** ./src/strategies/peak.ts ***!
  \********************************/
/*! no static exports found */function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,r,i,a,o){var s=Math.ceil(t.samplesPerPixel/t.resolution),l=t.scrollPosition*t.samplesPerPixel/t.samplerate,u=t.samplesPerPixel/t.samplerate,c=l+r*u,f=c+i*u,p=4*Math.abs(a),d=a>0?0:p,v=a>0?p:0,h=new Float32Array(o.buffer).copyWithin(d,v).fill(0,4*r,4*(r+i)),g=e.findIndex(function(t){return t.end>c&&t.start+t.offsetStart<f});if(-1===g)return h;for(var m=e.length-1,y=e[g],b=n.get(y.source),S=r;S<r+i;S++){var P=l+S*u;if(P>=y.end){if(g===m)return h;y=e[++g],b=n.get(y.source)}if(y.start+y.offsetStart>P)h.set([0,0,0,0],4*S);else{var _=P-u<y.start+y.offsetStart,O=P+u>y.end,x=_||O?1:0;if(null!=b){for(var M=P-y.start,w=Math.floor(M*t.samplerate),j=w+t.samplesPerPixel,E=b.length,k=E<j?E:j,T=0,W=0,C=w;C<k;C+=s){var A=b[C];A>W?W=A:A<T&&(T=A)}h.set([T,W,x,1],4*S)}else h.set([0,0,x,1],4*S)}}return h}},"./src/strategies/rms.ts":
/*!*******************************!*\
  !*** ./src/strategies/rms.ts ***!
  \*******************************/
/*! no static exports found */function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,r,i,a,o){var s=Math.ceil(t.samplesPerPixel/t.resolution),l=t.scrollPosition*t.samplesPerPixel/t.samplerate,u=t.samplesPerPixel/t.samplerate,c=l+r*u,f=c+i*u,p=4*Math.abs(a),d=a>0?0:p,v=a>0?p:0,h=new Float32Array(o.buffer).copyWithin(d,v).fill(0,4*r,4*(r+i)),g=e.findIndex(function(t){return t.end>c&&t.start+t.offsetStart<f});if(-1===g)return h;for(var m=e.length-1,y=e[g],b=n.get(y.source),S=r;S<r+i;S++){var P=l+S*u;if(P>=y.end){if(g===m)return h;y=e[++g],b=n.get(y.source)}if(y.start+y.offsetStart>P)h.set([0,0,0,0],4*S);else{var _=P-u<y.start+y.offsetStart,O=P+u>y.end,x=_||O?1:0;if(null!=b){for(var M=P-y.start,w=Math.floor(M*t.samplerate),j=w+t.samplesPerPixel,E=b.length,k=E<j?E:j,T=0,W=0,C=0,A=w;A<k;A+=s,C++){var I=b[A];I>0?T+=I*I:W+=I*I}var R=-Math.sqrt(W/C),D=Math.sqrt(T/C);h.set([R,D,x,1],4*S)}else h.set([0,0,x,1],4*S)}}return h}}})})},function(e,n){e.exports=t},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3);e.DomRenderWaveShaper=r.default,e.default=new r.default},function(t,e,n){var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),o=n(1),s=n(4),l=n(5),u=n(6),c=n(7),f=n(8),p=n(9),d=n(10),v=n(11),h=n(12),g=n(13),m=function(t){function e(e){void 0===e&&(e=h.default);var n=t.call(this,e)||this;return n.unregister=function(){},n.unregisterMap=new Map,n.canvasMap=new Map,n.cutCallbacks=[],n._options=i({},h.default,n._options),n}return r(e,t),Object.defineProperty(e.prototype,"scrollWidth",{get:function(){return this._duration*this._options.samplerate/this._options.samplesPerPixel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return i({},this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hammer",{get:function(){return this._hammer},enumerable:!0,configurable:!0}),e.prototype.setOptions=function(t){var e=i({},this.options);return this._options=i({},e,t),this.emitOptions(e,this.options),this},e.prototype.registerCanvas=function(t,e,n){var r=this,i=e.getContext("2d");if(null==i)throw Error("Cannot get context from canvas.");e.classList.add("waveshaper"),e.setAttribute("data-wave-id",t),e.style.width=this.options.width+"px",e.style.height=this.options.height+"px";var a=(devicePixelRatio||1)<1?1:devicePixelRatio||1;e.width=this.options.width*a,e.height=this.options.height,i.scale(a,1);var o=function(t,e){return d.default(e,t,i,n)};this.on(t,o),this.unregisterCanvas(t),this.canvasMap.set(t,function(){return r.off(t,o)});var s=v.default(this,e,g.dragState);return this.unregisterMap.set(t,s),this._options.registerSetsActive&&this.setActive.apply(this,this.activeWaveShapers.concat(t)),this},e.prototype.unregisterCanvas=function(t){var e=this.canvasMap.get(t);null!=e&&(e(),this.canvasMap.delete(t));var n=this.unregisterMap.get(t);(null!=n&&(n(),this.unregisterMap.delete(t)),this._options.registerSetsActive)&&(-1!=this.activeWaveShapers.indexOf(t)&&this.setActive.apply(this,this.activeWaveShapers.filter(function(e){return e!==t})));return this},e.prototype.emitCut=function(t,e,n){this.cutCallbacks.forEach(function(r){return r(t,e,n)})},e.prototype.onCut=function(t){this.cutCallbacks.push(t)},e.prototype.loadData=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return n.forEach(function(n){fetch(n.url).then(function(t){return t.arrayBuffer()}).then(function(e){return t.decodeAudioData(e)}).then(function(t){e.setData({id:n.id,data:t.getChannelData(0)}).process()}).catch(function(t){return console.log(t)})}),this},e.prototype.setInteraction=function(t){if(null==t)throw Error("Interaction container element could not be found.");this.unregister(),t.setAttribute("touch-action","none");var e=new o(t,s.default);return this._hammer=e,u.default(this,e,g.dragState),l.default(this,e),c.default(this,e),f.default(this,e),p.default(this,e),this.unregister=function(){e.destroy()},this},e.prototype.clearInteraction=function(){this.unregister(),this.unregister=function(){},this._hammer=null},e}(a.WaveShaper);e.default=m},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i={touchAction:"pan-y",recognizers:[[r.Pan,{direction:r.DIRECTION_HORIZONTAL}],[r.Pinch,{enable:!0}],[r.Tap]]};e.default=i},function(t,e){var n=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){e.on("tap",function(e){var r=t.options,i=t.options.getEventTarget(e.srcEvent);if(null!=r&&function(t,e){return"cut"===e.mode&&t.hasAttribute("data-wave-id")}(i,r)){var a=i.getAttribute("data-wave-id"),o=t.getTrack(a);if(null!=o){var s=i.getBoundingClientRect(),l=e.center.x-s.left,u=(r.scrollPosition+l)*(r.samplesPerPixel/r.samplerate);u=r.clampFn(u);var c=o.flattened.find(function(t){return t.start+t.offsetStart<=u&&t.end>=u});if(null!=c){var f=o.intervals.find(function(t){return t.id===c.id});if(null!=f){var p=n({},f),d=n({},f,{offsetStart:u-f.start,id:r.generateId()});f.end=u,o.intervals.push(d),t.flatten([o.id]),t.process([o.id],l,1),t.emitCut(n({},p),n({},f),n({},d))}}}}})}},function(t,e){var n=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){var i=function(t,e){return"drag"===e.mode&&t.hasAttribute("data-wave-id")};e.on("panstart",function(e){var a=t.options,o=t.options.getEventTarget(e.srcEvent);if(i(o,a)){var s=o.getAttribute("data-wave-id"),l=t.getTrack(s);if(null!=l){var u=o.getBoundingClientRect(),c=(a.scrollPosition+(e.center.x-u.left))*(a.samplesPerPixel/a.samplerate),f=l.flattened.find(function(t){return t.start+t.offsetStart<=c&&t.end>=c});if(null!=f){var p=l.intervals.find(function(t){return t.id===f.id});null!=p&&(r.startState=n({},p),e.srcEvent instanceof PointerEvent&&o.setPointerCapture(e.srcEvent.pointerId),r.options=a,r.activeSegment=p,r.activeSegmentStart=r.activeSegment.start,r.duration=p.end-p.start,r.activeSegment.index=1e3,r.dragWave=l)}}}}),e.on("panmove",function(e){var n=t.options.getEventTarget(e.srcEvent);if(null!=r.options&&null!=r.activeSegment&&null!=r.dragWave&&!r.dragging&&i(n,r.options)){r.dragging=!0;var a=e.deltaX*r.options.samplesPerPixel/r.options.samplerate,o=r.activeSegmentStart+a;(o=t.options.clampFn(o))+r.activeSegment.offsetStart<0&&(o=-r.activeSegment.offsetStart),r.activeSegment.start=o,r.activeSegment.end=o+r.duration,t.flatten([r.dragWave.id]),t.process([r.dragWave.id]),r.dragging=!1}}),e.on("panend",function(e){var a=t.options.getEventTarget(e.srcEvent);null!=r.options&&i(a,r.options)&&(null!=r.startState&&null!=r.activeSegment&&t.emitSegment(r.startState,n({},r.activeSegment)),r.activeSegment=null,r.activeSegmentStart=0,r.dragWave=null,r.options=null,r.duration=0,r.startState=null)})}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=500,r={panStart:0,panMax:0,options:null};e.default=function(t,e){var i=function(t,e){return"pan"===e.mode&&t.hasAttribute("data-wave-id")};e.on("panstart",function(e){var a=t.options,o=t.options.getEventTarget(e.srcEvent);i(o,a)&&(e.srcEvent instanceof PointerEvent&&o.setPointerCapture(e.srcEvent.pointerId),r.panMax=t.scrollWidth+n,r.panStart=a.scrollPosition)}),e.on("panmove",function(e){r.options=t.options;var n=t.options.getEventTarget(e.srcEvent);if(i(n,r.options)){var a=r.panStart-e.deltaX,o=Math.floor(a>0?a:0),s=o-r.options.scrollPosition;if(o!==r.options.scrollPosition&&!(o>r.panMax-r.options.width)){var l=s>0?r.options.width-s:0,u=Math.abs(s);t.setOptions({scrollPosition:o}).process(void 0,l,u,s)}}}),e.on("panend",function(e){var n=t.options.getEventTarget(e.srcEvent);null!=r.options&&i(n,r.options)&&(r.options=null,r.panStart=0,r.panMax=0)})}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=500,r={maxWidth:0,sppStart:0,options:null};e.default=function(t,e){var i=function(t,e){return"pan"===e.mode&&t.hasAttribute("data-wave-id")};e.on("pinchstart",function(e){var a=t.options,o=t.options.getEventTarget(e.srcEvent);i(o,a)&&(e.srcEvent instanceof PointerEvent&&o.setPointerCapture(e.srcEvent.pointerId),r.sppStart=a.samplesPerPixel,r.maxWidth=t.scrollWidth+n)}),e.on("pinchmove",function(e){r.options=t.options;var a=t.options.getEventTarget(e.srcEvent);if(null!=r.options&&i(a,r.options)&&null!=e.scale&&!(e.scale<=0)){var o=r.options.scrollPosition*r.options.samplesPerPixel,s=r.options.width*r.options.samplesPerPixel/2,l=r.sppStart*e.scale;if(0!=l){var u=r.options.width*l,c=u/2;if(!(u>=(t.scrollWidth+n)*r.options.samplerate)){var f=(o+s-c)/l;t.setOptions({samplesPerPixel:l,scrollPosition:f>=0?f:0}).process()}}}}),e.on("pinchend",function(e){var n=t.options.getEventTarget(e.srcEvent);null!=r.options&&i(n,r.options)&&(r.sppStart=0,r.maxWidth=0,r.options=null)})}},function(t,e){var n=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var r={activeSegment:null,activeSegmentSide:null,activeSegmentOffsetStart:0,activeSegmentOffsetEnd:0,dragWave:null,options:null,startState:null};e.default=function(t,e){var i=function(t,e){return"resize"===e.mode&&null!=t&&t.hasAttribute("data-wave-id")};e.on("panstart",function(e){var a=t.options,o=t.options.getEventTarget(e.srcEvent);if(i(o,a)){var s=o.getAttribute("data-wave-id"),l=t.getTrack(s);if(null!=l){var u=o.getBoundingClientRect(),c=(a.scrollPosition+(e.center.x-u.left))*a.samplesPerPixel/a.samplerate,f=l.flattened.find(function(t){return t.start+t.offsetStart<=c&&t.end>=c});if(null!=f){r.activeSegmentSide=c<f.start+f.offsetStart+(f.end-(f.start+f.offsetStart))/2?"left":"right";var p=l.intervals.find(function(t){return t.id===f.id});null!=p&&(r.startState=n({},p),e.srcEvent instanceof PointerEvent&&o.setPointerCapture(e.srcEvent.pointerId),r.options=a,r.activeSegment=p,r.activeSegmentOffsetStart=p.offsetStart,r.activeSegmentOffsetEnd=p.end,p.index=1e3,r.dragWave=l)}}}}),e.on("panmove",function(e){var n=t.options.getEventTarget(e.srcEvent);if(null!=r.dragWave&&null!=r.activeSegment&&null!=r.options&&i(n,r.options)){var a=t.options,o=e.deltaX*a.samplesPerPixel/a.samplerate,s="left"===r.activeSegmentSide?r.activeSegmentOffsetStart+o:r.activeSegmentOffsetEnd+o;(s=a.clampFn(s))<0&&(s=0);var l=r.activeSegment;("left"===r.activeSegmentSide?l.end-l.start-s:s-l.start-l.offsetStart)<=2||("left"===r.activeSegmentSide?l.offsetStart=s:l.end=s,t.flatten([r.dragWave.id]),t.process([r.dragWave.id]))}}),e.on("panend",function(e){var a=t.options.getEventTarget(e.srcEvent);null!=r.options&&i(a,r.options)&&(null!=r.startState&&null!=r.activeSegment&&t.emitSegment(r.startState,n({},r.activeSegment)),r.activeSegment=null,r.activeSegmentOffsetStart=0,r.activeSegmentOffsetEnd=0,r.activeSegmentSide=null,r.dragWave=null,r.options=null,r.startState=null)})}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,r){var i=e.height/2,a=e.width;n.fillStyle=r,n.clearRect(0,0,a,e.height);for(var o=0,s=!1,l=0;o<a;o++){var u=1===t[(c=4*o)+3];!s&&u?(s=!0,l=o):!s||u&&o!==a-1||(s=!1,n.fillRect(l,0,o-l,e.height))}n.fillStyle="black",n.beginPath(),n.moveTo(0,i);for(o=0;o<a;o++){var c=4*o;n.lineTo(o,Math.round(t[c]*i+i))}n.lineTo(a-1,i),n.moveTo(0,i);for(o=0;o<a;o++){c=4*o;n.lineTo(o,Math.round(t[c+1]*i+i))}n.lineTo(a-1,i),n.closePath();for(o=0;o<a;o++){0===t[(c=4*o)-4+2]&&1===t[c+2]&&n.rect(o,0,1,e.height)}n.fill()}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){var r=function(t){return i(t)};e.addEventListener("pointermove",r);var i=function(e){if(null!=n.options&&"drag"===n.options.mode&&null!=n.activeSegment&&null!=n.dragWave){var r=document.elementFromPoint(e.clientX,e.clientY);if(null!=r&&r instanceof HTMLCanvasElement){var i=r.getAttribute("data-wave-id");if(null!=i){var a=t.getTrack(i);if(null!=a&&n.dragWave.id!==i){var o=n.dragWave.intervals.indexOf(n.activeSegment);n.dragWave.intervals.splice(o,1),n.activeSegment.trackId=a.id,a.intervals.push(n.activeSegment),n.activeSegment.index=1e3;var s=n.dragWave.id;n.dragWave=a,t.flatten([a.id,s]),t.process([a.id,s])}}}}};return function(){e.removeEventListener("pointermove",r)}}},function(t,e,n){var r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r({},n(0).defaultConfig,{mode:"pan",height:150,getEventTarget:function(t){return t.target},generateId:function(){return Math.random().toString()},registerSetsActive:!0,clampFn:function(t){return t}});e.default=i},function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.dragState={activeSegment:null,activeSegmentStart:0,dragWave:null,options:null,duration:0,dragging:!1,startState:null}}]).default});
//# sourceMappingURL=waveshaper-dom.min.js.map